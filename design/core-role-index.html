<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="js/bui/assets/css/dpl.css">
    <link rel="stylesheet" href="js/bui/assets/css/bui.css">
    <title>Role Management</title>
</head>
<body>
<div class="container">
    <div class="row">
        <div class="span16">
            <div id="role-grid"></div>
        </div>
    </div>
</div>
<!-- JS -->
<script type="text/javascript" src="js/bui/src/jquery-1.8.1.min.js"></script>
<script type="text/javascript" src="js/bui/build/seed-min.js"></script>
<script type="text/javascript">
    var baseUrl="";
</script>
<script type="text/javascript">
    BUI.use(['bui/data','bui/grid'],function(Data,Grid){
        var store=new Data.Store({
            url:baseUrl+'/core/role/list',
            proxy:{
                method:'POST'
            },
            autoLoad:true
        });
        var columns=[{
            title:'Role Code',dataIndex:'rolecode',width:100,elCls:'center'
        },{
            title:'Role Name',dataIndex:'rolename',width:150,elCls:'center'
        },{
            title:'Current Status',dataIndex:'currentstatus',width:100,elCls:'center'
        },{
            title:'Handlers',elCls:'center',renderer:function(value,obj){
                return '<span class="grid-command edit-handler">edit</span>';
            }
        }];
        var grid=new Grid.Grid({
            render:'#role-grid',
            width:510,
            columns:columns,
            loadMask:true,
            store:store,
            plugins:[Grid.Plugins.RowNumber],
            tbar:{
                items:[{
                    btnCls:'button button-small',
                    text:'New',
                    listeners:{
                        click:function(){
                            alert('Clicked New Button');
                        }
                    }
                },{
                    btnCls:'button button-small',
                    text:'Edit',
                    listeners:{
                        click:function(){
                            var item=grid.getSelected();
                            if(item!=null){
                                alert('选择了'+item.rolename);
                            }
                        }
                    }
                }]
            },
            autoRender:true
        });
        grid.on('cellclick',function(ev){
            var record=ev.record;
            var field=ev.field;
            var target=$(ev.domTarget);
            if(target.hasClass('edit-handler')){
                alert('Edit Role:'+record.rolecode);
            }
        });
    });
</script>
</body>
</html>